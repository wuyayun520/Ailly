
//: Declare String Begin

/*: "CardCellId" :*/
fileprivate let str_endValue:String = "make make button age backCardC"
fileprivate let str_equalCreateName:String = "ellIdicon top"

/*: "icon_match_dislikeBtn_nor" :*/
fileprivate let str_appTitle:[Character] = ["i","c","o","n","_","m","a","t","c","h","_","d","i","s","l","i","k","e","B","t","n","_","n","o","r"]

/*: "icon_match_hiBtn_nor" :*/
fileprivate let str_sourceData:[Character] = ["i","c","o","n","_","m","a","t","c","h","_","h","i","B","t","n","_","n"]
fileprivate let str_makeSizeContent:String = "direction"

/*: "icon_match_likeBtn_nor" :*/
fileprivate let str_meValue:[Character] = ["i","c","o","n","_","m"]
fileprivate let str_imageName:String = "A"
fileprivate let str_youText:String = "if self extensiontch_"
fileprivate let str_sectionCurrentPhotoData:String = "tn_normake self"

/*: "Enable  Location" :*/
fileprivate let str_barData:[Character] = ["E","n","a","b","l","e"," "," ","L","o","c"]
fileprivate let str_modelName:String = "atplayeron"

/*: "lng" :*/
fileprivate let str_frontValue:[UInt8] = [0xa2,0xa0,0xa9]

private func userSize(wrap num: UInt8) -> UInt8 {
    return num ^ 206
}

/*: "lat" :*/
fileprivate let str_makeContent:[UInt8] = [0x74,0x61,0x6c]

/*: "icon_match_bg_location" :*/
fileprivate let str_plainTitle:[Character] = ["i","c","o","n","_","m"]
fileprivate let str_pushTitle:String = "atclist"
fileprivate let str_canName:String = "_bg_lotarget log"

/*: "In order to recommend nearby people based on location, we need your permission to use location permissions" :*/
fileprivate let str_haveStatusContent:[UInt8] = [0x91,0xb6,0xf8,0xb7,0xaa,0xbc,0xbd,0xaa,0xf8,0xac,0xb7,0xf8,0xaa,0xbd,0xbb,0xb7,0xb5,0xb5,0xbd,0xb6,0xbc,0xf8,0xb6,0xbd,0xb9,0xaa,0xba,0xa1,0xf8,0xa8,0xbd,0xb7,0xa8,0xb4,0xbd,0xf8,0xba,0xb9,0xab,0xbd,0xbc,0xf8,0xb7,0xb6,0xf8,0xb4,0xb7,0xbb,0xb9,0xac,0xb1,0xb7,0xb6,0xf4,0xf8,0xaf,0xbd,0xf8,0xb6,0xbd,0xbd,0xbc,0xf8,0xa1,0xb7,0xad,0xaa,0xf8,0xa8,0xbd,0xaa,0xb5,0xb1,0xab,0xab,0xb1,0xb7,0xb6,0xf8,0xac,0xb7,0xf8,0xad,0xab,0xbd,0xf8,0xb4,0xb7,0xbb,0xb9,0xac,0xb1,0xb7,0xb6,0xf8,0xa8,0xbd,0xaa,0xb5,0xb1,0xab,0xab,0xb1,0xb7,0xb6,0xab]

private func textView(control num: UInt8) -> UInt8 {
    return num ^ 216
}

/*: "&type=0" :*/
fileprivate let str_attachData:[Character] = ["&","t","y","p","e","=","0"]

/*: "mf/business/list" :*/
fileprivate let str_acceptName:String = "mf/butemp true"
fileprivate let str_outputName:String = "ss/liself extra manager status"
fileprivate let str_modeName:String = "sitem"

/*: "tab" :*/
fileprivate let str_layerText:[UInt8] = [0x62,0x61,0x74]

/*: "page" :*/
fileprivate let str_colorTitle:[UInt8] = [0x9c,0x8d,0x8b,0x89]

private func modeAppear(from num: UInt8) -> UInt8 {
    return num ^ 236
}

/*: "minAge" :*/
fileprivate let str_touchText:[UInt8] = [0xcf,0xcb,0xd0,0xa3,0xc9,0xc7]

fileprivate func chromaticColour(leading num: UInt8) -> UInt8 {
    let value = Int(num) + 158
    if value > 255 {
        return UInt8(value - 256)
    } else {
        return UInt8(value)
    }
}

/*: "maxAge" :*/
fileprivate let str_addErrorInValue:[UInt8] = [0x63,0x57,0x6e,0x37,0x5d,0x5b]

fileprivate func sleepingAccommodation(intimate num: UInt8) -> UInt8 {
    let value = Int(num) - 246
    if value < 0 {
        return UInt8(value + 256)
    } else {
        return UInt8(value)
    }
}

/*: "datingVideo" :*/
fileprivate let str_sharedText:[UInt8] = [0xa7,0xa2,0xb7,0xaa,0xad,0xa4,0x95,0xaa,0xa7,0xa6,0xac]

private func effectStyleInput(frame num: UInt8) -> UInt8 {
    return num ^ 195
}

/*: "limitNum" :*/
fileprivate let str_cellName:String = "cell file show addlimitNum"

/*: "expire" :*/
fileprivate let str_appName:String = "exiconir"
fileprivate let str_modeData:String = "size"

/*: "Too frequent requests, please try again later" :*/
fileprivate let str_centerData:[UInt8] = [0x5e,0x65,0x65,0x2a,0x6c,0x78,0x6f,0x7b,0x7f,0x6f,0x64,0x7e,0x2a,0x78,0x6f,0x7b,0x7f,0x6f,0x79,0x7e,0x79,0x26,0x2a,0x7a,0x66,0x6f,0x6b,0x79,0x6f,0x2a,0x7e,0x78,0x73,0x2a,0x6b,0x6d,0x6b,0x63,0x64,0x2a,0x66,0x6b,0x7e,0x6f,0x78]

/*: "mf/newFeature/dislike" :*/
fileprivate let str_aText:[Character] = ["m","f","/","n","e","w","F","e","a","t"]
fileprivate let str_topData:[Character] = ["u","r","e","/","d","i","s","l","i","k","e"]

/*: "uid" :*/
fileprivate let str_itemName:[UInt8] = [0x5,0x19,0x14]

private func collectionMan(record num: UInt8) -> UInt8 {
    return num ^ 112
}

/*: "mf/newFeature/like" :*/
fileprivate let str_commitTitle:String = "mf/neself row array frame player"
fileprivate let str_infoViewName:String = "wFearoute view return else message"
fileprivate let str_descriptionData:String = "view more self app/like"

/*: "didRemoveCell forRowAtIndex =  :*/
fileprivate let str_toValue:[Character] = ["d","i","d","R","e","m"]
fileprivate let str_defineCallName:String = "height coloroveC"
fileprivate let str_whiteName:String = "model list modelforR"
fileprivate let str_colorImageData:String = "err extension vardex = "

//: Declare String End

// __DEBUG__
// __CLOSE_PRINT__
//
//  EqualModelViewDelegate.swift
//  AbroadTalking
//
//  Created by Charlotte on 2023/5/18.
//

//: import UIKit
import UIKit

//: import JXPagingView
import JXPagingView

//: class TalkingClubVC: TalkingBaseViewController {
class EqualModelViewDelegate: SeamViewController {
    //: let CardCellId = "CardCellId"
    let CardCellId = (String(str_endValue.suffix(5)) + String(str_equalCreateName.prefix(5)))

    //: var cellItems = [SocialUserListModel]()
    var cellItems = [ControlWithModelType]() ///  数据模型数据
    //: var currenModel = SocialUserListModel.init()
    var currenModel = ControlWithModelType()
    //: var currenCell: TalkingClubCardItemCell?
    var currenCell: BottomAgendaItemReactiveCompatible?
    //: var isShowSubscre = false
    var isShowSubscre = false
    //: var clubUserData = Set<TalkingMatchRemoveRedoModel>()
    var clubUserData = Set<ProgressEquatable>()

    //: override func viewWillAppear(_ animated: Bool) {
    override func viewWillAppear(_ animated: Bool) {
        //: super.viewWillAppear(animated)
        super.viewWillAppear(animated)
    }

    //: override func viewDidDisappear(_ animated: Bool) {
    override func viewDidDisappear(_ animated: Bool) {
        //: super.viewDidDisappear(animated)
        super.viewDidDisappear(animated)
    }

    //: override func viewDidLoad() {
    override func viewDidLoad() {
        //: super.viewDidLoad()
        super.viewDidLoad()
        //: self.hideNavi = true
        self.hideNavi = true
        //: checkLocationAuth()
        blockMake()
        //: addNotifications()
        listRoom()
    }

    //: deinit {
    deinit {
        //: NotificationCenter.default.removeObserver(self)
        NotificationCenter.default.removeObserver(self)
    }

    //: private lazy var cardView: TalkingClubCardView = {
    private lazy var cardView: MakeCardView = {
        //: let height = ScreenHeight - TabBarViewHeight - StatusBarHeight - 117 - 12
        let height = kLet_clickData - kLet_viewDepthText - kLet_timeSenseValue - 117 - 12
        //: let view = TalkingClubCardView.init(frame: CGRect.init(x: 10, y: StatusBarHeight+12, width: ScreenWidth-20, height: height))
        let view = MakeCardView(frame: CGRect(x: 10, y: kLet_timeSenseValue + 12, width: kLet_cameraValue - 20, height: height))
        //: view.backgroundColor = .clear
        view.backgroundColor = .clear
        //: view.dataSource = self
        view.dataSource = self
        //: view.delegate = self
        view.delegate = self
        //: view.visibleCount = 10
        view.visibleCount = 10
        //: view.lineSpacing = 0.0
        view.lineSpacing = 0.0
        //: view.interitemSpacing = 0.0
        view.interitemSpacing = 0.0
        //: view.maxAngle = 0.0
        view.maxAngle = 0.0
        //: view.isAlpha = true
        view.isAlpha = true
        //: view.maxRemoveDistance = 150.0
        view.maxRemoveDistance = 150.0
        //: if LanguageManager.shared.direction == .rightToLeft {
        if FileReactiveCompatible.shared.direction == .rightToLeft {
            //: view.maxRemoveDistance = 130.0
            view.maxRemoveDistance = 130.0
        }
        //: view.layer.cornerRadius = 10.0
        view.layer.cornerRadius = 10.0
        //: view.registerClass(cellClass: TalkingClubCardItemCell.self, forellIdentifier: CardCellId)
        view.splitModel(cellClass: BottomAgendaItemReactiveCompatible.self, forellIdentifier: CardCellId)
        //: return view
        return view
        //: }()
    }()

    //: private lazy var disLikeBtn: UIButton = {
    private lazy var disLikeBtn: UIButton = {
        //: let img = UIButton()
        let img = UIButton()
        //: img.setImage(UIImage.eponymUp(name: "icon_match_dislikeBtn_nor"), for: .normal)
        img.setImage(UIImage.eponymUp(name: (String(str_appTitle))), for: .normal)
        //: img.addTarget(self, action: #selector(disLikeBtnClick), for: .touchUpInside)
        img.addTarget(self, action: #selector(backgroundStream), for: .touchUpInside)
        //: return img
        return img
        //: }()
    }()

    //: private lazy var hiBtn: UIButton = {
    private lazy var hiBtn: UIButton = {
        //: let img = UIButton()
        let img = UIButton()
        //: img.setImage(UIImage.eponymUp(name: "icon_match_hiBtn_nor"), for: .normal)
        img.setImage(UIImage.eponymUp(name: (String(str_sourceData) + str_makeSizeContent.replacingOccurrences(of: "direction", with: "or"))), for: .normal)
        //: img.addTarget(self, action: #selector(hiBtnClick), for: .touchUpInside)
        img.addTarget(self, action: #selector(original), for: .touchUpInside)
        //: return img
        return img
        //: }()
    }()

    //: private lazy var likeBtn: UIButton = {
    private lazy var likeBtn: UIButton = {
        //: let img = UIButton()
        let img = UIButton()
        //: img.setImage(UIImage.eponymUp(name: "icon_match_likeBtn_nor"), for: .normal)
        img.setImage(UIImage.eponymUp(name: (String(str_meValue) + str_imageName.lowercased() + String(str_youText.suffix(4)) + "likeB" + String(str_sectionCurrentPhotoData.prefix(6)))), for: .normal)
        //: img.addTarget(self, action: #selector(likeBtnClick), for: .touchUpInside)
        img.addTarget(self, action: #selector(moveMake), for: .touchUpInside)
        //: return img
        return img
        //: }()
    }()

    //: private lazy var emptyV: SocialEmptyView = {
    private lazy var emptyV: TargetEmptyView = {
        //: let v = SocialEmptyView()
        let v = TargetEmptyView()
        //: return v
        return v
        //: }()
    }()

    //: private lazy var locationBtn: UIButton = {
    private lazy var locationBtn: UIButton = {
        //: let btn = UIButton.init()
        let btn = UIButton()
        //: btn.setTitle("Enable  Location".localized, for: .normal)
        btn.setTitle((String(str_barData) + str_modelName.replacingOccurrences(of: "player", with: "i")).localized, for: .normal)
        //: btn.titleLabel?.font = UIFont.pingfangFont(type: .Medium, fontSize: 17)
        btn.titleLabel?.font = UIFont.pingfang(type: .Medium, fontSize: 17)
        //: btn.setTitleColor(.white, for: .normal)
        btn.setTitleColor(.white, for: .normal)
        //: btn.layer.cornerRadius = 25
        btn.layer.cornerRadius = 25
        //: btn.clipsToBounds = true
        btn.clipsToBounds = true
        //: btn.setBackgroundImage(UIImage.imageGradientColor(colors: UIColor.appGradientColor(), size: CGSize(width: ScreenWidth-80, height: 50)), for: .normal)
        btn.setBackgroundImage(UIImage.makeBackground(colors: UIColor.appToVoice(), size: CGSize(width: kLet_cameraValue - 80, height: 50)), for: .normal)
        //: btn.addTarget(self, action: #selector(locationBtnClick), for: .touchUpInside)
        btn.addTarget(self, action: #selector(locationVideo), for: .touchUpInside)
        //: return btn
        return btn
        //: }()
    }()

    //: private lazy var swipedFinishView: TalkingClubCardSwipedFinishView = {
    private lazy var swipedFinishView: ClubView = {
        //: let v = TalkingClubCardSwipedFinishView()
        let v = ClubView()
        //: v.countdownBlock = { [weak self] in
        v.countdownBlock = { [weak self] in
            //: guard let self = self else { return }
            guard let self = self else { return }
            //: self.beginRequestData()
            self.assemblageApplicationBegin()
        }
        //: view.addSubview(v)
        view.addSubview(v)
        //: v.snp.makeConstraints { make in
        v.snp.makeConstraints { make in
            //: make.edges.equalToSuperview()
            make.edges.equalToSuperview()
        }
        //: return v
        return v
        //: }()
    }()
}

// MARK: - 定位权限监听

//: extension TalkingClubVC {
extension EqualModelViewDelegate {
    //: func checkLocationAuth() {
    func blockMake() {
        //: TalkingLocationManager.shared().requestLocationAuthorizaiton()
        PopEventThen.project().equalAppealAuthorizaiton()
        //: TalkingLocationManager.shared().getAuthBlock { [weak self] (type: PermissionType) in
        PopEventThen.project().localGroup { [weak self] (type: FreeNumeric) in
            //: guard let self = self else {return}
            guard let self = self else { return }
            //: switch type {
            switch type {
            //: case .firstEntry:
            case .firstEntry: // 首次进入
                //: self.refreshViewStatus()
                self.showMini()

            //: case .userRestricted:
            case .userRestricted: // 拒绝
                //: self.refreshViewStatus()
                self.showMini()
                // 展示设置弹窗
                //: self.showSettingsAlertView()
                self.center()

            //: case .alwaysAllowed:
            case .alwaysAllowed: // 允许
                //: self.setupView()
                self.willStraddleShow()
                //: self.beginRequestData()
                self.assemblageApplicationBegin()
            }
        }
        /// 上报经纬度
        //: TalkingLocationManager.shared().getLocationBlock { success, latitude, longitude in
        PopEventThen.project().bindLike { success, latitude, longitude in
            //: if success {
            if success {
                //: SocialRequestManager.req_uploadPosition(params: ["lng": longitude, "lat": latitude]) { succeed, result, errorModel in
                CameraRequestManager.offLine(params: [String(bytes: str_frontValue.map{userSize(wrap: $0)}, encoding: .utf8)!: longitude, String(bytes: str_makeContent.reversed(), encoding: .utf8)!: latitude]) { _, _, _ in
                }
            }
        }
    }

    /// 设置弹窗
    //: func showSettingsAlertView() {
    func center() {
        //: guard TalkingLocationManager.shared().locationType == .userRestricted else {
        guard PopEventThen.project().locationType == .userRestricted else {
            //: return
            return
        }
        //: self.view.addSubview(locationBtn)
        self.view.addSubview(locationBtn)
        //: locationBtn.snp.makeConstraints { make in
        locationBtn.snp.makeConstraints { make in
            //: make.bottom.equalToSuperview().offset(-33)
            make.bottom.equalToSuperview().offset(-33)
            //: make.leading.equalTo(40)
            make.leading.equalTo(40)
            //: make.trailing.equalTo(-40)
            make.trailing.equalTo(-40)
            //: make.height.equalTo(50)
            make.height.equalTo(50)
        }
    }

    /// 刷新视图状态
    //: private func refreshViewStatus() {
    private func showMini() {
        // 是否开启定位判断缺省图
        //: if TalkingLocationManager.shared().locationType != .alwaysAllowed {
        if PopEventThen.project().locationType != .alwaysAllowed {
            //: self.view.removeAllSubviews()
            self.view.removeAllSubviews()
            //: self.view.addSubview(emptyV)
            self.view.addSubview(emptyV)
            //: emptyV.snp.makeConstraints { make in
            emptyV.snp.makeConstraints { make in
                //: make.top.equalToSuperview().offset(200)
                make.top.equalToSuperview().offset(200)
                //: make.leading.trailing.bottom.equalToSuperview()
                make.leading.trailing.bottom.equalToSuperview()
            }
            //: emptyV.imgV.image = UIImage.eponymUp(name: "icon_match_bg_location")
            emptyV.imgV.image = UIImage.eponymUp(name: (String(str_plainTitle) + str_pushTitle.replacingOccurrences(of: "list", with: "h") + String(str_canName.prefix(6)) + "cation"))
            //: emptyV.desLab.text = "In order to recommend nearby people based on location, we need your permission to use location permissions".localized
            emptyV.desLab.text = String(bytes: str_haveStatusContent.map{textView(control: $0)}, encoding: .utf8)!.localized
        }
    }

    //: @objc private func locationBtnClick() {
    @objc private func locationVideo() {
        //: let url = URL(string: UIApplication.openSettingsURLString)
        let url = URL(string: UIApplication.openSettingsURLString)
        //: if let url = url, UIApplication.shared.canOpenURL(url) {
        if let url = url, UIApplication.shared.canOpenURL(url) {
            //: UIApplication.shared.open(url, options: [:], completionHandler: nil)
            UIApplication.shared.open(url, options: [:], completionHandler: nil)
        }
    }
}

//: extension TalkingClubVC {
extension EqualModelViewDelegate {
    //: @objc private func disLikeBtnClick() {
    @objc private func backgroundStream() {
        // 埋点
        //: uploadRecord.uploadRecordEvent(eventID: click_home_dislike, toUid: "\(self.currenModel.uid)")
        kLet_textData.historicalPaper(eventID: kLet_buttonTagMicName, toUid: "\(self.currenModel.uid)")
        /// 最后一条时，无法滑动
        //: if isShowSubscre {
        if isShowSubscre {
            //: cardView.restoreCellLocation()
            cardView.southSub()
            //: EditTextThen.share.func__pushToSubscribeAlert(appendParams: "&type=0")
            EditTextThen.share.addShowParams(appendParams: (String(str_attachData)))
            //: return
            return
        }
        //: disLikeReq()
        switchlineWithReq()
//        if !cardView.isUserInteractionEnabled && cellItems.count == 1 {
//            self.func__showStatusBarErrorMsg(showMsg: "Too frequent requests, please try again later".localized)
//            disLikeReq()
//            return
//        }

        //: cardView.removeTopCardViewFromSwipe(direction: .Left)
        cardView.swipe(direction: .Left)
    }

    //: @objc private func hiBtnClick() {
    @objc private func original() {
        //: let uid = self.currenModel.uid
        let uid = self.currenModel.uid
        //: if uid > 0 {
        if uid > 0 {
            //: EditTextThen.share.func__pushToPriveteChatVC(chatID: "\(uid)")
            EditTextThen.share.fullMoon(chatID: "\(uid)")
            // 埋点
            //: uploadRecord.uploadRecordEvent(eventID: click_home_hi, toUid: "\(uid)")
            kLet_textData.historicalPaper(eventID: kLet_soundRecordData, toUid: "\(uid)")
        }
    }

    //: @objc private func likeBtnClick() {
    @objc private func moveMake() {
        // 埋点
        //: uploadRecord.uploadRecordEvent(eventID: click_home_like, toUid: "\(self.currenModel.uid)")
        kLet_textData.historicalPaper(eventID: kLet_listData, toUid: "\(self.currenModel.uid)")
        //: if isShowSubscre {
        if isShowSubscre {
            //: cardView.restoreCellLocation()
            cardView.southSub()
            //: EditTextThen.share.func__pushToSubscribeAlert(appendParams: "&type=0")
            EditTextThen.share.addShowParams(appendParams: (String(str_attachData)))
            //: return
            return
        }
        //: likeReq()
        polaroidLandCamera()
//        if !cardView.isUserInteractionEnabled && cellItems.count == 1 {
//            self.func__showStatusBarErrorMsg(showMsg: "Too frequent requests, please try again later".localized)
//            likeReq()
//            return
//        }
        //: cardView.removeTopCardViewFromSwipe(direction: .Right)
        cardView.swipe(direction: .Right)
    }
}

/// 初始化模型数据
//: extension TalkingClubVC {
extension EqualModelViewDelegate {
    //: func removeAllData() {
    func theErase() {
        //: self.cellItems.removeAll()
        self.cellItems.removeAll()
    }

    //: func beginRequestData() {
    func assemblageApplicationBegin() {
        //: let reqModel = TalkingRequestModel.init()
        let reqModel = WithTitleThen()
        //: reqModel.showErrorStatusBar = false
        reqModel.showErrorStatusBar = false
        //: reqModel.requestPath = "mf/business/list"
        reqModel.requestPath = (String(str_acceptName.prefix(5)) + "sine" + String(str_outputName.prefix(5)) + str_modeName.replacingOccurrences(of: "item", with: "t"))
        //: reqModel.requestType = .GET
        reqModel.requestType = .GET
        //: reqModel.params = ["tab": 1,
        reqModel.params = [String(bytes: str_layerText.reversed(), encoding: .utf8)!: 1,
                           //: "page": 0,
                           String(bytes: str_colorTitle.map{modeAppear(from: $0)}, encoding: .utf8)!: 0,
                           //: "minAge": 18,
                           String(bytes: str_touchText.map{chromaticColour(leading: $0)}, encoding: .utf8)!: 18,
                           //: "maxAge": 80,
                           String(bytes: str_addErrorInValue.map{sleepingAccommodation(intimate: $0)}, encoding: .utf8)!: 80,
                           //: "datingVideo": 0]
                           String(bytes: str_sharedText.map{effectStyleInput(frame: $0)}, encoding: .utf8)!: 0]
        //: ProgressHUD.show()
        ModelReactiveCompatible.fromTarget()
        //: GJ.startRequest(model: reqModel) { succeed, result, errorModel in
        kLet_nextTitle.photoLive(model: reqModel) { succeed, result, errorModel in
            //: ProgressHUD.dismiss()
            ModelReactiveCompatible.dataConverterCan()
            //: guard succeed == true else {
            guard succeed == true else {
                //: if errorModel?.errorCode == 10889 {
                if errorModel?.errorCode == 10889 { // 卡片额度用完
                    //: let json = JSON(result ?? {})
                    let json = JSON(result ?? {})
                    //: self.swipedFinishView.show(limitNum: json["limitNum"].int, expire: json["expire"].int)
                    self.swipedFinishView.anyLimitExpire(limitNum: json[(String(str_cellName.suffix(8)))].int, expire: json[(str_appName.replacingOccurrences(of: "icon", with: "p") + str_modeData.replacingOccurrences(of: "size", with: "e"))].int)
                    //: } else {
                } else {
                    //: if errorModel?.errorMsg.isEmpty == false {
                    if errorModel?.errorMsg.isEmpty == false {
                        //: self.func__showStatusBarErrorMsg(showMsg: errorModel?.errorMsg ?? "")
                        self.oversight(showMsg: errorModel?.errorMsg ?? "")
                    }
                    //: self.addEmptyView()
                    self.doingHandle()
                }
                //: return
                return
            }
            //: let resultArr = result as! [Dictionary<String, Any>]
            let resultArr = result as! [[String: Any]]
            //: for dict in resultArr {
            for dict in resultArr {
                //: if let model = SocialUserListModel.deserialize(from: dict as? Dictionary) {
                if let model = ControlWithModelType.deserialize(from: dict as? Dictionary) {
                    //: self.cellItems.append(model)
                    self.cellItems.append(model)
                }
            }
            //: if self.cellItems.count > 0 {
            if self.cellItems.count > 0 {
                //: self.swipedFinishView.dismiss()
                self.swipedFinishView.reasonOff()
                //: if resultArr.count > 0 {
                if resultArr.count > 0 {
//                    if self.cellItems.count == 1 {
//                        self.cardView.isUserInteractionEnabled = false
//                    }else {
//                        self.cardView.isUserInteractionEnabled = true
//                    }
                    //: self.cardView.reloadData()
                    self.cardView.surchargeData()
                    //: }else {
                } else {
                    //: self.func__showStatusBarErrorMsg(showMsg: "Too frequent requests, please try again later".localized)
                    self.oversight(showMsg: String(bytes: str_centerData.map{$0^10}, encoding: .utf8)!.localized)
                }
                //: } else {
            } else {
                //: self.swipedFinishView.show(limitNum: nil, expire: nil)
                self.swipedFinishView.anyLimitExpire(limitNum: nil, expire: nil)
            }
        }
    }

    //: private func addEmptyView() {
    private func doingHandle() {
        //: self.view.removeAllSubviews()
        self.view.removeAllSubviews()
        //: self.view.addSubview(self.emptyV)
        self.view.addSubview(self.emptyV)
        //: self.emptyV.snp.makeConstraints { make in
        self.emptyV.snp.makeConstraints { make in
            //: make.top.equalToSuperview().offset(200)
            make.top.equalToSuperview().offset(200)
            //: make.leading.trailing.bottom.equalToSuperview()
            make.leading.trailing.bottom.equalToSuperview()
        }
    }

    //: private func disLikeReq() {
    private func switchlineWithReq() {
        //: let reqModel = TalkingRequestModel.init()
        let reqModel = WithTitleThen()
        //: reqModel.requestPath = "mf/newFeature/dislike"
        reqModel.requestPath = (String(str_aText) + String(str_topData))
        //: reqModel.requestType = .POST
        reqModel.requestType = .POST
        //: reqModel.params = ["uid": self.currenModel.uid]
        reqModel.params = [String(bytes: str_itemName.map{collectionMan(record: $0)}, encoding: .utf8)!: self.currenModel.uid]
        //: reqModel.showErrorStatusBar = false
        reqModel.showErrorStatusBar = false

        //: GJ.startRequest(model: reqModel) { succeed, result, errorModel in
        kLet_nextTitle.photoLive(model: reqModel) { _, result, errorModel in
            //: if errorModel?.errorMsg.isEmpty == false {
            if errorModel?.errorMsg.isEmpty == false {
                //: self.func__showStatusBarErrorMsg(showMsg: errorModel?.errorMsg ?? "")
                self.oversight(showMsg: errorModel?.errorMsg ?? "")
            }
            //: if errorModel?.errorCode == 10888 {
            if errorModel?.errorCode == 10888 {
                //: EditTextThen.share.func__pushToSubscribeAlert(appendParams: "&type=0")
                EditTextThen.share.addShowParams(appendParams: (String(str_attachData)))
                //: self.isShowSubscre = true
                self.isShowSubscre = true

                //: } else if errorModel?.errorCode == 10889 {
            } else if errorModel?.errorCode == 10889 { // 卡片额度用完
                //: let json = JSON(result ?? {})
                let json = JSON(result ?? {})
                //: self.swipedFinishView.show(limitNum: json["limitNum"].int, expire: json["expire"].int)
                self.swipedFinishView.anyLimitExpire(limitNum: json[(String(str_cellName.suffix(8)))].int, expire: json[(str_appName.replacingOccurrences(of: "icon", with: "p") + str_modeData.replacingOccurrences(of: "size", with: "e"))].int)
            }
        }
    }

    //: private func likeReq() {
    private func polaroidLandCamera() {
        //: let reqModel = TalkingRequestModel.init()
        let reqModel = WithTitleThen()
        //: reqModel.requestPath = "mf/newFeature/like"
        reqModel.requestPath = (String(str_commitTitle.prefix(5)) + String(str_infoViewName.prefix(4)) + "ture" + String(str_descriptionData.suffix(5)))
        //: reqModel.requestType = .POST
        reqModel.requestType = .POST
        //: reqModel.params = ["uid": self.currenModel.uid]
        reqModel.params = [String(bytes: str_itemName.map{collectionMan(record: $0)}, encoding: .utf8)!: self.currenModel.uid]
        //: reqModel.showErrorStatusBar = false
        reqModel.showErrorStatusBar = false

        //: GJ.startRequest(model: reqModel) { succeed, result, errorModel in
        kLet_nextTitle.photoLive(model: reqModel) { _, result, errorModel in
            //: if errorModel?.errorMsg.isEmpty == false {
            if errorModel?.errorMsg.isEmpty == false {
                //: self.func__showStatusBarErrorMsg(showMsg: errorModel?.errorMsg ?? "")
                self.oversight(showMsg: errorModel?.errorMsg ?? "")
            }
            //: if errorModel?.errorCode == 10888 {
            if errorModel?.errorCode == 10888 {
                //: EditTextThen.share.func__pushToSubscribeAlert(appendParams: "&type=0")
                EditTextThen.share.addShowParams(appendParams: (String(str_attachData)))
                //: self.isShowSubscre = true
                self.isShowSubscre = true

                //: } else if errorModel?.errorCode == 10889 {
            } else if errorModel?.errorCode == 10889 { // 卡片额度用完
                //: let json = JSON(result ?? {})
                let json = JSON(result ?? {})
                //: self.swipedFinishView.show(limitNum: json["limitNum"].intValue, expire: json["expire"].intValue)
                self.swipedFinishView.anyLimitExpire(limitNum: json[(String(str_cellName.suffix(8)))].intValue, expire: json[(str_appName.replacingOccurrences(of: "icon", with: "p") + str_modeData.replacingOccurrences(of: "size", with: "e"))].intValue)
            }
        }
    }

    /// 刷新个人资料接口
    //: @objc private func func__requestUserInfo() {
    @objc private func viewInfo() {
        //: AppManagerRequest.func__requestUserInfo { succeed, result, errorModel in
        GiftManagerRequest.makeEnable { _, _, _ in
            //: self.isShowSubscre = false
            self.isShowSubscre = false
            //: self.beginRequestData()
            self.assemblageApplicationBegin()
        }
    }
}

//: extension TalkingClubVC: TalkingClubCardViewDataSource, TalkingClubCardViewDelegate {
extension EqualModelViewDelegate: JogObjectProtocol, LengthTalkingViewDelegate {
    //: func numberOfCountInCardView(cardView: TalkingClubCardView) -> Int {
    func ofImport(cardView _: MakeCardView) -> Int {
        //: return cellItems.count
        return cellItems.count
    }

    //: func cardViewCellForRowAtIndex(cardView: TalkingClubCardView, index: Int) -> TalkingClubCardViewCell {
    func dismissOn(cardView: MakeCardView, index: Int) -> ClubThen {
        //: let cell = cardView.dequeueReusableCellWithIdentifier(identifier: CardCellId) as? TalkingClubCardItemCell
        let cell = cardView.per(identifier: CardCellId) as? BottomAgendaItemReactiveCompatible
        //: let model = cellItems[index]
        let model = cellItems[index]
        //: cell?.setCellData(model: model)
        cell?.everyName(model: model)
        //: if index == 0 {
        if index == 0 {
            //: self.currenModel = model
            self.currenModel = model
            //: self.currenCell = cell
            self.currenCell = cell
        }

        //: cell?.layer.cornerRadius = 10.0
        cell?.layer.cornerRadius = 10.0
        //: cell?.layer.masksToBounds = true
        cell?.layer.masksToBounds = true
        //: return cell!
        return cell!
    }

    //: func CellForRowAtIndexModel(index: Int) -> SocialUserListModel {
    func toAGreaterExtentIndex(index: Int) -> ControlWithModelType {
        //: let model = cellItems[index]
        let model = cellItems[index]
        //: return model
        return model
    }

    //: func didRemoveLastCell(cardViewCell: TalkingClubCardViewCell, forRowAtIndex: Int) {
    func decisionMaking(cardViewCell _: ClubThen, forRowAtIndex _: Int) {
        /// 数据查看完
        //: self.removeAllData()
        self.theErase()
//        cardView.isUserInteractionEnabled = false
        //: beginRequestData()
        assemblageApplicationBegin()
    }

    //: func didRemoveCell(cardView: TalkingClubCardView, cardViewCell: TalkingClubCardViewCell, forRowAtIndex: Int, direction: Int, isGesture: Bool) {
    func toGesture(cardView _: MakeCardView, cardViewCell _: ClubThen, forRowAtIndex: Int, direction: Int, isGesture: Bool) {
        //: if isGesture {
        if isGesture {
            //: if direction == 1 {
            if direction == 1 {
                // 埋点
                //: uploadRecord.uploadRecordEvent(eventID: click_home_dislike, toUid: "\(self.currenModel.uid)")
                kLet_textData.historicalPaper(eventID: kLet_buttonTagMicName, toUid: "\(self.currenModel.uid)")
                //: disLikeReq()
                switchlineWithReq()
                //: }else {
            } else {
                // 埋点
                //: uploadRecord.uploadRecordEvent(eventID: click_home_like, toUid: "\(self.currenModel.uid)")
                kLet_textData.historicalPaper(eventID: kLet_listData, toUid: "\(self.currenModel.uid)")
                //: likeReq()
                polaroidLandCamera()
            }
        }
        //: cellItems.remove(at: 0)
        cellItems.remove(at: 0)
        //: if let model = cellItems.first {
        if let model = cellItems.first {
            //: self.currenModel = model
            self.currenModel = model
        }

        /// 最后一条
//        if cellItems.count == 1 {
//            cardView.isUserInteractionEnabled = false
//            beginRequestData()
//        }
        //: printLog(message:"didRemoveCell forRowAtIndex = \(forRowAtIndex)")
        printLog(message: (String(str_toValue) + String(str_defineCallName.suffix(4)) + "ell " + String(str_whiteName.suffix(4)) + "owAtIn" + String(str_colorImageData.suffix(6))) + "\(forRowAtIndex)")
    }

    //: func didDisplayCell(cardViewCell: TalkingClubCardViewCell, forRowAtIndex: Int) {
    func imageIndex(cardViewCell _: ClubThen, forRowAtIndex _: Int) {}

    //: func didMoveCell(cardView: TalkingClubCardView, cardViewCell: TalkingClubCardViewCell, forMovePoint: CGPoint) {
    func workingPapers(cardView _: MakeCardView, cardViewCell _: ClubThen, forMovePoint _: CGPoint) {}

    //: func beginMoveCell(cardView: TalkingClubCardView, cardViewCell: TalkingClubCardViewCell) {
    func beginLikeCompartment(cardView _: MakeCardView, cardViewCell _: ClubThen) {
//        if isShowSubscre {
//            cardView.isUserInteractionEnabled = false
//        }
    }
}

//: extension TalkingClubVC {
extension EqualModelViewDelegate {
    //: private func setupView() {
    private func willStraddleShow() {
        //: self.view.backgroundColor = .clear
        self.view.backgroundColor = .clear
        //: self.view.removeAllSubviews()
        self.view.removeAllSubviews()
        //: self.view.addSubview(cardView)
        self.view.addSubview(cardView)
        //: self.view.addSubview(disLikeBtn)
        self.view.addSubview(disLikeBtn)
        //: self.view.addSubview(hiBtn)
        self.view.addSubview(hiBtn)
        //: self.view.addSubview(likeBtn)
        self.view.addSubview(likeBtn)

        //: hiBtn.snp.makeConstraints { make in
        hiBtn.snp.makeConstraints { make in
            //: make.top.equalTo(cardView.snp.bottom).offset(28)
            make.top.equalTo(cardView.snp.bottom).offset(28)
            //: make.centerX.equalTo(self.view)
            make.centerX.equalTo(self.view)
            //: make.size.equalTo(61)
            make.size.equalTo(61)
        }

        //: disLikeBtn.snp.makeConstraints { make in
        disLikeBtn.snp.makeConstraints { make in
            //: make.size.top.equalTo(hiBtn)
            make.size.top.equalTo(hiBtn)
            //: make.trailing.equalTo(hiBtn.snp.leading).offset(-48)
            make.trailing.equalTo(hiBtn.snp.leading).offset(-48)
        }

        //: likeBtn.snp.makeConstraints { make in
        likeBtn.snp.makeConstraints { make in
            //: make.size.top.equalTo(hiBtn)
            make.size.top.equalTo(hiBtn)
            //: make.leading.equalTo(hiBtn.snp.trailing).offset(48)
            make.leading.equalTo(hiBtn.snp.trailing).offset(48)
        }
    }

    /// 添加通知
    //: private func addNotifications() {
    private func listRoom() {
        //: NotificationCenter.default.addObserver(self,
        NotificationCenter.default.addObserver(self,
                                               //: selector: #selector(self.func__requestUserInfo),
                                               selector: #selector(self.viewInfo),
                                               //: name: APPLE_IAP_SUBSCRIBE_SUCCEED_NOTIFICATION,
                                               name: USER_UPDATE_LOUNGEPLUSINFO_NOTIFICATION,
                                               //: object: nil)
                                               object: nil)
    }
}
